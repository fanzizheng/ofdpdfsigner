//-----------------------------------------------------------------------------------------
// test
//获取图片接口时返回图片和图片的宽和高
//var docpage_1_imagedata = "http://127.0.0.1:7655/image/aa_sign_0.jpg";
var docpage_1_width = 992;
var docpage_1_height = 1403;
//-----------------------------------------------------------------------------------------
//关闭按钮的图片
var closefile_imagedata = "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";
//前一页按钮图片
var previouspage_imagedata = "iVBORw0KGgoAAAANSUhEUgAAABUAAAAmCAMAAAAcJyCnAAABGlBMVEUAAAAAAAAAAAAAAAAAAAAzMzMrKyskJCQgICAcHBwaGhorKysnJyckJCQrKyszMzMxMTEsLCwrKysxMTEuLi4xMTEyMjIyMjIxMTEzMzMwMDAyMjIyMjIxMTExMTEzMzMzMzMyMjIyMjIxMTEwMDAzMzMwMDAyMjIyMjIxMTEzMzMyMjIxMTExMTExMTEyMjIyMjIyMjIzMzMyMjIyMjIyMjIxMTEzMzMzMzMxMTEyMjIyMjIyMjIxMTEyMjIyMjIyMjIyMjIyMjIyMjIyMjIzMzMzMzMyMjIzMzMzMzMzMzMyMjIyMjIzMzMyMjIzMzMyMjIzMzMzMzMyMjIzMzMyMjIyMjIyMjIzMzMzMzMyMjIyMjIzMzMzMzMpuiO5AAAAXXRSTlMAAQMEBQUGBwgJCgwNDhIUFRcYPkJZXGFjZGVlZ2hpaWprbG1vb3B1dnd+f4GDh4mKi42Oj5CRkZKTk5SVl5iZmtLV19je4ubm5+jp6uzv7/Dw8fT3+Pn6+/z9/v6zZP5RAAABEklEQVQoz3WS11bCUBBFoxJsxN4rghFR1GissdeoWEgkUS/Z//8bPrmWM+B93GvOnJm5x7LUy0+Hd+NtcCWCG01Lr8CbZN0lgK9NKV+KgOTUEXS5DnAwIuAaAL5g9lwDSC+kvBgCWTAqYBUg21buMZAEBUHdOmB86V5JgdaOLdwXYiA9l/LiE2BOhHvX+gdgvIG/sGcmBj6vpHwyBMzlmDzeA2B2HXXmEDC1fkWnHoHvfTm/lZuNgCQYVNWVFDBbOYXLz4DxhiW1F2OgeVhQ1VWAVk3HwH0BMm9IRaYcA01fNyl3+OD/wvAbnDOnY8j2OgaSIz1JKQKSY9Uk7wIkG23rNDJ417R3NYJbTa2++fvriR8em0whszNllgAAAABJRU5ErkJggg==";
//下一页按钮图片
var nextpage_imagedata = "iVBORw0KGgoAAAANSUhEUgAAABUAAAAmCAMAAAAcJyCnAAAA7VBMVEUAAAAAAAAAAAAzMzMrKyskJCQgICAcHBwaGhozMzMuLi4nJyckJCQwMDAtLS0rKysoKCgwMDAwMDAyMjIwMDAyMjIyMjIyMjIxMTExMTEwMDAyMjIyMjIxMTExMTEwMDAzMzMwMDAyMjIyMjIxMTExMTEzMzMyMjIxMTExMTEzMzMxMTEyMjIyMjIxMTExMTEzMzMyMjIyMjIxMTExMTEyMjIxMTEyMjIzMzMyMjIyMjIyMjIzMzMzMzMzMzMzMzMyMjIyMjIzMzMyMjIyMjIyMjIzMzMzMzMzMzMyMjIzMzMzMzMyMjIzMzMzMzNzDHclAAAATnRSTlMAAQQFBgcICQoKCw0OEBESEzU6YWRna3Fyc3R1dnd4eXl6ent9fn6AgYKCg4SFh4iIiYuMkcrP0tTf5Ofn6+zt7u/w8/T19fb3+fr8/f4eLE7JAAABAUlEQVQoz4WSWVfCMBBGK2rrAu4rjYhbK2IF9xWpWhKl6f3/P8dXM+k55vGeyZeZyQ3WH163w0CeR9AnC5LmwGdb0ngK0G64NLrUgO5GLm4NAfJdGZIBcChoNDTAJBYNrt5UwMgLOasAUhnSmwD6WHZyZYH8QFTPphb4SWRIZgDTFZ2s3FpgvOc9aQGdzLg4HHwDRs25eO3OAqNNEbLcK4EXQcNOCbyJWQYl8L7lVp5rQKv5v7BxVDNeq2+BcexeTwtAi4k71l9xs18BH+4mw6QA9GlU883qfyXq9cmmAPuOas1rfC2jiwJfYWUAVOhZXX1JDYIn0MmipBv3zztLEv4Cjos/7HbdvlwAAAAASUVORK5CYII=";
//盖骑缝章
var ridestamp_imagedata = "iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABp1BMVEUAAADmGjPbJEDbJEXaJUTZJEXaJUXZJkXZJkTZJUTZJkXZJ0XZKEfZKUfZKkjaLEraLkzaL0zaL03bMk7bM1DbNlPcNVLcNlLcOlbdOlbeQ13eRF/fRF7fSGHfSWPgS2ThUWnhUmnhV2/iVW3iVm3iWG/jWXDjW3LjZHrkX3XkaH3lY3flZHjlZXrnbYDocYTocoTocoXpdojpd4npe4zqf4/qgJHqipvsipjtjZvtmKfukZ7vmKXvmaXvp7Pwq7fwrLfxoq30rKz0ra30rq70r6/0sLD0sbH0s7P1tLz1trb1tr71t771x8/2ubn2u7v2vLz2wMD2wcH3vr73wMD3wMb3xMT3yMj32N34w8n4xMT4xcr4xsv40ND42N343OH5yMj5ycn5ysr5y8/5zdH50tL509P51NT52Nj54eb6zc36z8/6z9P60NP60dH62dn629v63t765un709P709X709b71Nb75OT75eX77O7819j82tz829v83Nz87+/94OD99PT99/j+4uL+4+P+5eX+5ub++Pj++vr++vv++/v/5OT/5ub/5+dosNWNAAAACnRSTlMAChxGS2tvxdn+n+JYkQAAAVBJREFUSMdjYAADRnZOLgKAg4kBBTBzWdhCgAqXPIhS5ZIFUepcMlBxG15WVC0sXDk9EGDMpQuiTLg0QZQZlxpUvIefbVQLPi2hjt6kaoGCEacl2TsGSUuKdyRhLTgBfi3NWf7uzm5+SfXEaunOdnUOSstPD3NxTmwlSktrlFN4Q6aDlV1cW6xTQAsxWhKdCoq0wFlXKaLCJYQILTVOqfESQPUCIOxb6FRMWEuwV6McUDW3pxCQFK0M9CKopdk5wx7kKO0uUxBlXu5US0hLlVOdBpe4gl50V5m+siSXdKdTNiEteU7tUlxGzV1gYM3F1eGRQJQWLsMmkA5LLqK0gB3GxeUD1FECpIlxGNT7pV3VXc3CxHkfEshiuQZ8OtGKxAUyJCoF+YE28YgQGZVkJBhykiUZiZ+cLEZyRiajuBjhBSz5VdJovU9ACxmNK1KacABXnLShQFPMPwAAAABJRU5ErkJggg==";
//位置盖章按钮图片
var posstamp_imagedata = "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";
//关键字盖章按钮图片
var keystamp_imagedata = "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";
//验证按钮图片
var verify_imagedata = "iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAB7FBMVEUAAAAzM8yVlepbW8hYWMZaWshZWcZaWsdaWsVaWsdaWsfY4/9bW8e6wfhaWshaWsfY4/+KiuyssvNbW8haWsdzdtJbW8haWsfY4/9bW8dcXMddXchdXsheXshfX8hgYMlgYclhYcliYsliY8pjZMpkZctlZstmZ8xnaMxoacxpas1pa81qa81qbM5rbM5rbc5sbc5sbs5tb89vcc9vcdBwc9BxdNFydNF0d9J1eNJ2eNJ4e9R5fNR6fdV7ftV8f9V8f9Z9gdZ+gdZ+gteAg9eBhdiChtiDhtiDh9iFidqHh+uHi9uIjNuJjduLj9yLkNyNkd2Nkt2Qld+Rlt+TmOCVmuGYneKYnuKZn+OboeOboeSdo+SfpeWgpuWgpuagp+ahp+aiqOejquekqPKlq+ilrOinq/Knreinruior+mqsOqrsuqrsuutteuutuyvtuyvt+2wuO2xuO2yue6yuu60uva0vO61vPa1ve+2v++3v/C3wPC4wPC4wfG5wfG6w/K9xfK9xvO+x/PAyfTByvTByvXBy/XCy/XDzPXEzfXEzfbFzvbFz/bG0PfH0ffI0fjI0vjJ0vjJ0/jK0/jK1PjK1PnL1fnM1vnN1/rO2PrP2vvQ2vvQ2v3Q2/vR2/zS3PzT3vzU3/3W4P7Y4/8Cz5HFAAAAGXRSTlMABRg4OmZnenx8f5CVur3Dy9bW5+jy9P7+s5EphAAAAdFJREFUSMfl0fs/U3Ecx/EvXaRkuqC36cIOlqOS28FQijZqS21yujq5JC3ydUsyqh2Z0YxillTsH/VLj3o8+Gw755GfeP32+eH5y/vDGGOMHTsTid7JREaUFkNEOk8k6ibNlIlDKBOPECYu2Wnikx1GA9lutJBtJiZ50UyZmOTH25E/HddK/pW2x0nPNbqB6KQVdEp0sr5M92t/jDyl0Hl3deQP3XSf98fI2khCUqrBkG7RVLrBkJqUwFKgsxSWoZdkMOju/0k+AOHvJZwHgKtngSskcS+EzNaNalwOFvepqtpeIEnPn0mSGdxy1xyW6ghSen+xfqbmSzFuNeaJS6Kp9VPY4/k206aEvdy19sBJEJei9k9z/+M3vyvEsgAA03wW3BYUfu2ydf98VUmQJ6shm91xvQi81i5vqA6g15rnM6Ihsjbk8XycJIixfHCUTyi3wW/ek4NCNnBpdtwGjHldDqdTVgkyOLduHXvkLwQPDssBALgxF2oxArz2jiy3U6SpY2nc59t8iYdPV75vBl5X+SeqzO5FK3hNF+fv3xGkzF6eL4qiACBXEIRzOSUAcLEIlgslkiSZdvH7mshpveIUO5ypT2QeYuxg8lEdHTnAtgC0NSZalg8xXwAAAABJRU5ErkJggg==";
//分隔图片
var fenge_imagedata = "iVBORw0KGgoAAAANSUhEUgAAAAEAAAAoCAIAAACw1AcgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAANSURBVBhXYxjUgIEBAACgAAFIzXMRAAAAAElFTkSuQmCC";
//拖动印章
var stamp_imagedata = "iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAYAAACLz2ctAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkNCNDBDRUE4NjA0MzExRUJCRThGQzhEMEVBRjc4MTYyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkNCNDBDRUE5NjA0MzExRUJCRThGQzhEMEVBRjc4MTYyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Q0I0MENFQTY2MDQzMTFFQkJFOEZDOEQwRUFGNzgxNjIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Q0I0MENFQTc2MDQzMTFFQkJFOEZDOEQwRUFGNzgxNjIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5XM5KjAAAcv0lEQVR42uxd65Wc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";
//验证失败
var verify_error_imagedata = "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACdklEQVRIS52VP2gUQRTGvzeLyiVHIOYm4t62IigpbUSxDsHWJqWHYkS0CQRRG0n8A7ERC2svhYKFIrYiothZyAmxMcVdjuT2ODW7F83tzZPJ3iZ76+7tJlvuzrxv3m/e9y25BbMEYB7AZ2IxM9Ss1rCPh3HyoHu4NU0G7hPzsgdRGrFr38ktmGsAxnVNBr9H17iWb1W/7kWDAbEpzRnFuEOAJKCjwHN5u/6I3ELxLcCTvYKKwR8EG9NZO9HFXWnOCsYtBvJ+HfpFgi4OrVdfUrtYtNRfVSbQWQDC/45PpMSFNBGNZVO2LoFxLyhOgKOI54cb9YcEKNL1nCPWBLrdxwQ6F6BJwxXF0tvXIMLdXGP1iS7un7X36E54i5+DcToNVxwWfXIQbubGR59SpbIV1N0R0C+y4MqCJTwgfQJpuIZb1Up4WpKwDBQIOonDBcIXwVQKX2gcllSBRFyhndFpSfLNf4jCC+OmKwuWTB34ztYmOrpITDfCmxj8zfAOTeV+rqykOT6xAz0tjmxdNhgLuw7tY5TJjLEC+uSONK8Kxm0AMsDC4AaBTmQ1Y5/RdjdtB9csQtkSmIjEgTdKdcpZzBhrtDgs0WnJYsbYS07CEs2WNDNGo377DnrBFYslmi072TVmFVmoF2m4KAuWpFFsj1lFRd2lQVFPbsEqAWohPC1xWJJEnFFrAkZ/1BPwzgOujNiry+RKcx3sj2JS5KaZSXcSweUxaC5v1xapLc2PYJxiwGXiB8GfKK1o9LuPSz0ToDMKvGEwX88162X6XTCPC/CUYPzINeuvgj/RXgX0+j/SOuYxnzeg1hx0Xkvb3hgYdvsRie75B2HRrii2K7cAAAAAAElFTkSuQmCC";
//验证成功
var verify_ok_imagedata = "iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAADjUlEQVRIS8WWX2xURRTGf2fu3XJ3CyZoghAVISqJL9jGALESjUGIiX+JCcQYfDD+AzRiBQrayEJbaYwhCH3wUemD0SgpLZCUBn0wgTexiUaoYiRKVBQ1arv/7swxd8t2t90u3ZYS5+3OnHu++c6c+eYTLjeSGgQBczRn64y4lYjUoyxQCATSCD+gesqp6ZOY92U6zQWSkq6UUiot1O7K3hF6sk6Uh4FFl93U8OKACj2+1c7BN2r6x4svB/tIvcS37gWnbjswF/CqACqEWOAXI2b30G3mXdZI9D0yRoMldWYQC7ehbAZmTAJkbGgG4e10zm8nKf8WFotgSfUD3+0A1wgkrgCo8OsQmD3p0OwkKWE0OQIWb8u+pCpvAcE0ABVSpEV0a+r1mv0jYLVtuthqeBS4YRqBCqnOe04fjJpGSGowwwtbRdg0yWYYta9ZNfD47cKFQTj6nZauWRX2ZnJ+swTtQ/MJ/T6Qatp7XOLRWexdZVhXZ/g7AwveyR9R6RjA91dKoiV8xIkemmr5IkbJewwblhkyFt77wrHpmCtLZ6x7TOKt4X5FX5wK2Mwa2H63Yf1SgyfQ2e9o/tTxV6Y8myAdErTlTqDcNRWwtvsM65cY4jH48CulsdfyRwWxEuGExFtzP2lJF945T9jaYOg67Th4WvOlGTtqY7ClwdC03JC10HNGefqQJVtevaJ6iJyXoDX3O3BdYXbjEsPuFYbBHOz4zPJ+/2jARAwalxleaTDETMTIse2442JqwtpcLGM2/xroXO2x9EbhzxS82mv54OtiKzc1GLYsN0TsDg8oG45YfhuaEAjJMxvnzOYk4OBaj/p5gnXwTLel96zyXL1h1wpDzkHfWeXJTyzpccpc4X6clHhLtkNFNo4NuHW2sO8Bw70Lhxl+fk65/xYh8KHrG8fmPsevgxMzKoqwdEhiZ+ZR55musb9FF3XRtcKB1R6L50JUyGju+PfKsz2Wn0e0vDrA/D2bSEFumiV0P+GxcDac/FFZ87Hln2x1ACVRwwqS18ZY2CpaWRvrr5d8w3SfcZNmBBS1MUKPLIA1cuTqq/4lrvGW7Msq0j7t7xmmKdXs7Ytg/p+XOk8w8iBe+BpCZA2uzIMoe9LWf3N8D1JonaT6iZh7/uq7q5JezftGI0+J8BBahW8UBlQ57Ds9UL1vLL1Clxyxydk6NawCjRzxzUAcSCGcAzkljmOuCkf8HyuRdlxr+CweAAAAAElFTkSuQmCC";
//+
var zoomout_imagedata = "iVBORw0KGgoAAAANSUhEUgAAAF8AAABfCAYAAACOTBv1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkNBM0M1M0UxNjA0MzExRUJCMzI2RDZEMUM0RDNBQUFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkNBM0M1M0UyNjA0MzExRUJCMzI2RDZEMUM0RDNBQUFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Q0EzQzUzREY2MDQzMTFFQkIzMjZENkQxQzREM0FBQUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Q0EzQzUzRTA2MDQzMTFFQkIzMjZENkQxQzREM0FBQUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6F7z2AAAABh0lEQVR42uzcMUoDQRiG4UTFSluRXCPxAPbxLJK0aU1rWs+RWNtZSAQPE60s9B+YNCuYJey6GXxe+EDJFPqgsAqT/nA47BXYTWwSu8qfr2P3sceSvomjAuHvYsvYdewsL328yq/Bb6lxbPbL67P8WwG/haY1zkzgt9OooTPw9+i8oTPw/3vw4cMXfPiCD1/w4Qs+fMGHL/jwBR++4MMXfPiCDx++4MMXfPiCD1/w4Qs+fMEvGj/dX32KbWJfB7q6HeLXvsm+4yp+9Va3mu/HTfmT3u5b3Wq+5P2SfvKnLDppkvBHHDpp5Gmnu/oJ/5VDJ60T/oJDJy2O8qPPnMWflrxXx4PBoJcf/t9il7GL2CmfxvuIPcduYw/b5/xty7xDru5fuf3S/r0g+PAFH77gwxd8+IIPX/DhCz58wYcv+PAFHz58wYcv+PAFH77gwxd8+IIPX/DhCz78htrUOPMOv53qvFXBGn47LRo6A3+Pdr1VwTyfKaLt9f+Sqr5VwWevcq2+lL4FGAAbeHebMetD0gAAAABJRU5ErkJggg==";
//-
var zoomin_imagedata = "iVBORw0KGgoAAAANSUhEUgAAAF8AAABfCAYAAACOTBv1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI1RjcxNUI3NjA3ODExRUI4RENDOTQxMDQ1NzE3MDU0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI1RjcxNUI4NjA3ODExRUI4RENDOTQxMDQ1NzE3MDU0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MjVGNzE1QjU2MDc4MTFFQjhEQ0M5NDEwNDU3MTcwNTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MjVGNzE1QjY2MDc4MTFFQjhEQ0M5NDEwNDU3MTcwNTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7ktJPLAAABKElEQVR42uzcMW7CQBRFURusVNQo8jq8AXqyFgRt2qSmzTrsPh0FSiQWg6jNH2loQks8FOdKbwOHkfwr6nEcK5VphgA+fMGHL/jwBR++4MMXfPiCD1/w4Qs+fMGHL/jw4Qs+fMGHL/jwBR++4MMXfPiCD1/w4euupus6Ck/w8t9i37FzbLSH75x913/xP2J9bBVbeJP/0iL7Dtm7avIv8c5m0pL3Mb38HYsibRO+L26ZOqdmueqE/8uhSD8Jf8+hSPtZPn0+WUxa8h7mbdtW+fg/xV5jy9gLn4d3iR1im9jX7c6/1edpqi+uP7grl1MTPnzBhy/48AUfvuDDF3z4gg9f8OELPnzBhy/48OELPnzBhy/48AUfvuDDF3z4gg9f8OEL/lN1FWAANf1xt52dEtwAAAAASUVORK5CYII=";
//打开文件
var openfile_imagedata = "iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABzlBMVEUAAAAAAAAAAAAAAAAAAAAzMzMrKyskJCQgICAcHBwaGhozMzMXFxcuLi4rKyskJCQiIiIoKCguLi4sLCwrKysvLy8uLi4sLCwrKyszMzMwMDAuLi4tLS0qKiowMDAsLCwxMTEtLS0wMDAvLy8uLi4zMzMyMjIxMTEzMzMwMDAvLy8uLi4wMDAvLy8uLi4wMDAvLy8xMTEwMDAwMDAyMjIxMTEyMjIyMjIxMTEwMDAyMjIwMDAwMDAyMjIyMjIxMTEwMDAyMjIxMTEzMzMyMjIyMjIxMTEzMzMyMjIxMTEyMjIxMTExMTExMTEwMDAyMjIxMTEyMjIyMjIzMzMxMTEyMjIxMTExMTEyMjIyMjIxMTEyMjIyMjIxMTExMTEyMjIyMjIzMzMyMjIyMjIyMjIyMjIyMjIzMzMyMjIyMjIyMjIzMzMyMjIyMjIyMjIzMzMyMjIzMzMzMzMzMzMyMjIyMjIzMzMzMzMzMzMxMTEyMjIyMjIyMjIyMjIyMjIzMzMxMTEzMzMyMjIyMjIyMjIzMzMyMjIzMzMyMjIzMzMyMjIyMjIyMjIzMzMzMzMzMzMyMjIzMzMyMjIzMzMyMjIzMzMyMjIyMjIzMzMzMzO/A6smAAAAmXRSTlMAAQIDBAUGBwgJCgoLCwwODxMWFxgbHB0eHiAhIiQlKSotMDEyMjM0Nzs8PUBBQkVGSUpLTU5RUlNVVlpbW1xeX2FiZGVmaWprbXFyc3d5gIGEhYaHipGTmZqdnp+hp6mqqrK2t72+v8DBwsTFxsjJy87T1NXX19jZ3uDi5Onr7O3t7u/w8PHx8vLz9PX19vf4+vv7/Pz9/v6ndRQoAAAB9klEQVRIx7XWaVPTUBSH8RNoKRRFsVprrVr3FSwVVFxAsVbFBVFRcN9wb0XEBa1KwbWpKYi5N/9v64s0mkwyzb2OPm9zfjMnS9MQ/eOa4ts69+1uX9kkNr194FFRm2f67PS9vsV+0/XLs7lpVVW/z+oAoD/dodScV7ovnu3aHI/Fkm2Zqy/mAJQO1dUE9q1beiY4UO4mIqLW9nSHvdQKL7/kPgc+bKAIrX3503DEil1eIjIJYDR1kx7D1fsFXuKkDjAtQxqmLo/YGn4LPeoej+45pgEoRqmC8WbHyQ6D7XWD0KkCB3A7QBVMtDgOpblRWF1f50ghoqVXymBHyQ3Cr4Cv185dsDeYDhMpqdczcQ9AiXfu68BuNRLRot4GL0DLHn6bdzTH8GOnddQDkBLp6LS36wbHgVrA1aCB/VLg/H8HQxw9UmB9YTIhBaj5z69DDNgyQfBE7plvT3qDFgiMMPhnsEtKFawrQ6gv1sPXz8XATMwEoZzYPO4ETbCmJDbPj1dPOiu40ceECVpHBTe620BEFTxPfhLcKGveuLHDTAx8XmWC/HXBjR6ETKCqghv1V58l0UpJSZBvlAPGGZID6kZJMBaWA8ZpkgPaJkkwvrAKNEEwYP1L58XmK1ust8bWNzr3jWlDgd/vmfjBzBG/+tqCf/158ws7ttvHo4ndIQAAAABJRU5ErkJggg==";
//保存文件
var savefile_imagedata = "iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAA+VBMVEUAAAAAAAAAAAAAAAAAAAAzMzMrKysAAAAgICAzMzMuLi4rKysnJyckJCQuLi4rKys1NTUpKSkvLy8rKyspKSkuLi4tLS0sLCwqKiowMDAtLS0sLCwyMjIwMDAuLi4yMjIvLy8wMDAzMzMxMTEyMjIxMTEzMzMwMDAyMjIxMTExMTEyMjIxMTEzMzMxMTEzMzMyMjIyMjIyMjIyMjIyMjIyMjIzMzMyMjIzMzMyMjIzMzMyMjIzMzMzMzMzMzMyMjIyMjIzMzMzMzMyMjIzMzMyMjIyMjIzMzMyMjIyMjIzMzMzMzMyMjIzMzMyMjIzMzMzMzMzMzMzMzPf2s9ZAAAAUnRSTlMAAQIDBAUGBwgKCwwNDhYYGBkbHh8hIiMkJSgpLjA3PUZLUFhcXV9gYGNpepKfoKWnscDBwsfIy87S1NfX3d7f4eLj5Ojp6uzv8PDx9fX6+/z+pwx4dQAAARBJREFUSMft1FdTwzAQBOClg+gJkBAIvYfea0IJWJgS2P//Y3jwgIMlX848ZthH6b4Zze3YAABgZLtONxc5pKQU0Jtwyj/ffcmUvPjFHFNj8z6wTEEUPGBFAAwLWmC31h9J0k4owTQwdEuStqgDBsBgjSTDohrA3PteJQCYqmdXEsBA1d2VCL5flVcDmDuStJNqgEWS5HUrMP5zvxQdxGDNC15LY1Fmn3TAyT/4K7gy/YksfIhg1P1+T0Tg+UMciWAmK6iX+5I5bvviPk/3fmf/TQYVZ6vDDyLocXuQ19qVtbhKVtA4PEgmaNOmV1XzjRjMq8BZDHpvNGCjqZzyc+v5nc7mOnO7gTj9fr7ZEU1+ARv61m9GHIB7AAAAAElFTkSuQmCC";
//打印文件
var printfile_imagedata = "iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABnlBMVEUAAAAAAAAAAAAAAAAAAAAAAAArKyskJCQgICAcHBwkJCQiIiIgICAwMDArKysoKCg2NjYmJiYxMTEsLCwrKysrKyswMDAtLS0sLCwqKiovLy8uLi4tLS0tLS0sLCwxMTEwMDAuLi4xMTEwMDAwMDAvLy8zMzMuLi4tLS0xMTExMTEuLi4yMjIxMTEwMDAzMzMvLy8uLi4xMTEzMzMwMDAxMTExMTEyMjIxMTEzMzMyMjIxMTExMTExMTEzMzMxMTEzMzMxMTExMTEzMzMzMzMyMjIyMjIxMTEyMjIyMjIzMzMzMzMyMjIxMTEyMjIyMjIxMTEzMzMyMjIyMjIyMjIyMjIxMTEyMjIyMjIzMzMyMjIzMzMxMTEyMjIyMjIzMzMxMTEzMzMyMjIyMjIzMzMxMTEzMzMzMzMyMjIyMjIzMzMzMzMxMTEyMjIyMjIyMjIyMjIzMzMzMzMzMzMyMjIyMjIyMjIzMzMzMzMzMzMyMjIyMjIyMjIzMzMyMjIzMzMzMzMyMjIyMjIzMzMzMzMzMzMyMjIyMjIzMzMzMzN1X8ASAAAAiXRSTlMAAQIDBAUGBwgJDg8QEBITExQVFxgeICIjJCYnKDM0NDU3OTo7PDw9Pj5ESEhJSktMTU5VX2JobG5vcXN8fX6Cg4aMjI2Oj5GUlZaXmpujpKWmp7GytLW2t7q9vr/Aw8PExMbHycrP1NXX19je4OLl5ubn7e7v8PDx8vP09fX29vf4+fr7/P3+/pa2TqMAAAHeSURBVEjH7dbXW9NQAMbhL7SlbRyxtYqCA3GPuBXFLahYtUy3OMA9sVKCprWppo3ff+1FFU/GKaePXvq7yUXOm+c5WecAv0ocfV52JJVf9ScRKH7BZYvqw4kA6KuxZd/2BcAZkl/vFEYiKtyukLyk+cZ35En3eAyRxQbq5HjcD66RCwYkdVXIsTCwpGBduU2wvvIfAEDHMDkvBWttcuTPU12x1TTNm6R9xJR0zCEf7DfNHVkA2t53DSrmzR7SsPsL28jeg7uKF/eaxylYSsPfXpmseCT5GY7K+LEU0FciyZoSsDcAwHV1UMoBwHl10DgMIP1YHXD+oJ675bUB2JirNu+rKljsr4D7dHomsulnbiSwMjFJmU/RQPo9rJr7d6BrtBBotLsl6PVCT2CnDzh47wMbQ19ffZsPfMBFH9hih9olgh9XYdwXQbKnO1BPSgRPskD23MticbbcBPGc0ErxLlU/FosvTq8GAC2t68vyTbDZEpqKCWB8ua6nNd8KZBnAJnHSj0Qg+VX2imBGAawZFBrQlgbQhBbPGtFgISN7l4xSGORJ91Qy+u1OnHBDAGdJ1h5OTEY0cc8hedm/sGP7EluH7weCm5OhesvNyY3O4MQ6+19Xa5KcNydTv8f9BApxoDY4fFOvAAAAAElFTkSuQmCC";
//父DIV宽
var width = 0;
//父DIV高
var height = 0;
//父DIV id
var id;
//文档ID
var currfileid = "";
//当前页
var currentpage=0;
//总页数
var totalpagecount = 0;
//工具栏
var div_tools;
//文档显示区
var div_pagearea;
//关闭文档
var img_closefile;
//上一页
var img_previouspage;
//下一页
var img_nextpage;

//goto 输入框
var input_gotopage;
//总页数
var text_totalpagecount;
//goto按钮
var img_gotopage;
//位置盖章
var img_posstamp;
//关键字盖章
var text_keystamp;
//关键字盖章
var img_keystamp;
//验证印章
var img_verify;
//骑缝章
var img_ridestamp;
//放大
var img_zoomout;
//缩小
var img_zoomin;
//打开本地文件
var img_openfile_local;
//保存文件到本地
var img_savefile_local;
//打印文件
var img_printfile_local;
//是否使用usbkey
var checkbox_usbkey;
//显示区域
var div_pageshowarea;
//显示区域 宽
var pagearea_width;
//显示区域 高
var pagearea_height;
//文档页面显示
var div_zoompagearea;
//印章拖动背景
var div_droppagearea;
//var table_docpage;
//var table_tr_docpage = [];
//var table_td_docpage = [];
//var img_docpage;
var img_docpage_Array_Count = 20;
var img_docpage_Array= [];
//拖动印章
var img_stamp;
//进度条
var div_progressbox;
var text_progresstext;
//keywordstamp
var div_keywordstampbox;
//是否在该位置盖章
var div_postionstampbox;
//验证结果box
var div_verifyresultbox;
var img_verifyImage;
var text_verify;
var text_verify_message1;
var text_verify_message2;
var text_verify_message3;
var text_verify_message4;
var text_verify_message5;
var text_verify_message6;
var text_verifynumber;
var verifylist;
var verifylist_index = 0;
//显示二维码
var div_qrcodebox;
var img_qrcode;

//当前页面图片数据
var g_currpageimagedata;
//缩放比例
var g_Ratio_MAX = 0.0;
var g_Ratio = 0.0;
var g_Ratio_MIN = 0.0;
var g_Ratio_hundredth = 0.0;
//传输数据的buffer大小
var buffersize = 3800;
//是否打开文档成功
var isOpenDoc = false;
//盖章类型 0:无类型;1:位置盖章;2:关键字盖章;3:骑缝章
var add_Seal_Type = 0;
//轮询二维码任务ID
var qrcode_taskID;
//轮询二维码定时器
var qrcode_timer;
//回调函数
var callback_applyqrcode;
var callback_verify;
var callback_getsignfiledata;
    
//------------------------------------------------------------------------------------------
/******************************************私有函数****************************************/
//------------------------------------------------------------------------------------------
//停止拖动
function stopdropstamp()
{
    if ( img_stamp != null && img_stamp != undefined ) {
        img_stamp.onmousemove = null;
    }
    if ( div_droppagearea != null && div_droppagearea != undefined ) {
        div_droppagearea.onmousemove = null;
        div_droppagearea.onmouseup = null;
        div_droppagearea.releaseCapture && div_droppagearea.releaseCapture();
    }
}
//------------------------------------------------------------------------------------------
//隐藏拖动印章
function hidedropstamp()
{
    if ( img_stamp != null && img_stamp != undefined ) {
        img_stamp.style.display="none";
    }
}
//------------------------------------------------------------------------------------------
function stopqrcodetimer()
{
    if ( qrcode_timer != null && qrcode_timer != undefined ) {
        clearTimeout(qrcode_timer);
        qrcode_timer = null;
    }
}
//------------------------------------------------------------------------------------------
function getSealQRCodeStatus()
{

    var jsondata = new Object();
    jsondata.taskId = qrcode_taskID;
    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/qrcode/getsealqrcodestatus",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
            if ( data.status == 0 ) {
                hideprogress();
                if (data.data.scanResult == "0") {
                    stopqrcodetimer();
                    qrcode_timer = setTimeout(getSealQRCodeStatus, 2000);
                } else {
                    stopqrcodetimer();
                    hideQRCode();

                    if ( func_callback_verify(data.data.certType,data.data.certNo,
                        data.data.certName,data.data.certificateType,
                        data.data.certificateSno,data.data.corpName,
                        data.data.sealName,data.data.sealType) ) {
                        var sealid = "";
                        if ( func_callback_getsealid != null && func_callback_getsealid != undefined ) {
                            sealid = func_callback_getsealid(data.data.certType, data.data.certNo,
                                data.data.certName, data.data.certificateType,
                                data.data.certificateSno, data.data.corpName,
                                data.data.sealName, data.data.sealType);
                        } else {
                            sealid = data.data.sealName;
                        }
                        if ( add_Seal_Type == 1 ) {
                            signstamp_positon(sealid);
                        } else if (add_Seal_Type == 21) {
                            keywordstamp_1(sealid);
                        } else if (add_Seal_Type == 22) {
                            keywordstamp_2(sealid);
                        } else if (add_Seal_Type == 3) {
                            signstamp_ridestamp(sealid)
                        } else {
                            alert('不支持此种类型盖章！类型为'+add_Seal_Type);
                        }

                    } else {
                        alert('经过系统权限验证，您无权对该文件进行盖章！');
                    }

                }
            } else {
                stopqrcodetimer();
                qrcode_timer = setTimeout(getSealQRCodeStatus, 2000);
                hideprogress();
                //alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            stopqrcodetimer();
            qrcode_timer = setTimeout(getSealQRCodeStatus, 2000);
            hideprogress();

            //if ( isShowMessage ) {
            //alert(XMLHttpRequest.status);
            //alert(XMLHttpRequest.readyState);
            //alert(textStatus);
            //alert(errorThrown);
            // }

        }
    });


}
//------------------------------------------------------------------------------------------
//获取盖章二维码
function getSealQRCode()
{
    var applyInfoobj = func_callback_applyqrcode();
    var jsondata = new Object();
    jsondata.bizType = "YZM1";
    jsondata.certificateType = applyInfoobj.certificateType;
    jsondata.certificateSno = applyInfoobj.certificateSno;
    jsondata.corpName = applyInfoobj.corpName;
    jsondata.sealType = applyInfoobj.sealType;
    //alert(jsondata.sealType);
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: encodeURI("data="+JSON.stringify(jsondata)),
        url:"http://127.0.0.1:7655/qrcode/getsealqrcode",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
            if ( data.status == 0 ) {
                hideprogress();
                qrcode_taskID = data.data.taskId;
                showQRCode(data.data.qrCode);
                stopqrcodetimer();

                qrcode_timer = setTimeout(getSealQRCodeStatus, 2000);


            } else {
                hideprogress();
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            //if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
           // }

        }
    });
}
//------------------------------------------------------------------------------------------
function signstamp_ridestamp(sealid) {
    var jsondata = new Object();
    jsondata.fileID = currfileid;
    jsondata.sealId = sealid;
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/ridingstamp",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( data.status == 0 ) {
                //alert(data.message);

                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
            }

        }
    });
}
//------------------------------------------------------------------------------------------
//位置盖章
function signstamp_positon(sealid)
{
    var start_left = $(div_droppagearea).offset().left + 30;//左边距
    var start_top = $(div_droppagearea).offset().top + 30;//顶边距
    var seal_left = $(img_stamp).offset().left;
    var seal_top = $(img_stamp).offset().top;
    
    
    //var destleft = (seal_left - start_left+$(img_stamp).width()/2)/g_Ratio;
    //var desttop = (seal_top - start_top+$(img_stamp).height()/2)/g_Ratio;
    var destleft = (seal_left - start_left)/g_Ratio;
    var desttop = (seal_top - start_top)/g_Ratio;
    hidedropstamp();

    //alert(destleft+"*"+desttop);
    //alert("sealid:"+sealid);

    var jsondata = new Object();
    jsondata.fileID = currfileid;
    jsondata.pageCode = currentpage;
    jsondata.left = destleft;
    jsondata.top = desttop;
    jsondata.sealId = sealid;
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/postionstamp",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( data.status == 0 ) {
                //alert(data.message);

                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
            }

        }
    });
}
//------------------------------------------------------------------------------------------
//拖动印章
function dragImg(obj) {
	
	div_droppagearea.setCaptue && div_droppagearea.setCaptue();
      //也是为了兼容IE8 window.event(IE8) 它的事件对象属性在window中
      
      //获取偏移量 保持鼠标的指针 不动  offsetLeft返回当前元素左上角相对于 HTMLElement.offsetParent节点的左边界偏移的像素值。
      //偏移量 offset
      var ox = $(obj).width()/2;
      var oy = $(obj).height()/2;
      var object_left = div_droppagearea.offsetLeft;
      var object_Top = div_droppagearea.offsetTop;
      var object_width = $(div_droppagearea).width();
      var object_height = $(div_droppagearea).height();
      var drapobj_width = $(obj).width();
      var drapobj_height = $(obj).height();
      
	obj.ondblclick=function(){
	
		showposttionstampbox();
		//alert("盖章");
	};
	obj.onclick=function(){
		
		showposttionstampbox();
		//alert("盖章");
	};
	
	obj.onmousedown = function (event){
		stopdropstamp();
	}
	obj.onmousemove = function (event) {
  	event = event ||window.event;
  	var left = event.offsetX - (drapobj_width/2) + obj.offsetLeft;
    var top = event.offsetY - (drapobj_height/2)+obj.offsetTop;
    
    if(left < object_left) {
    	left = object_left;
    	//console.log(1);
    } 
    if(top < object_Top) {
    	top = object_Top;
    	//console.log(2);
    }
    
    if ( left + drapobj_width > object_left + object_width ) {
    	left = object_left + object_width - drapobj_width;
    	//console.log(3);
    }
    
    if ( top + drapobj_height > object_Top + object_height ) {
    	top = object_Top + object_height - drapobj_height;
    	//console.log(4);
    }
          
    obj.style.left = left +"px";
    obj.style.top = top +"px";
  	
  };
  //理清逻辑 当鼠标的指针剪头在待拖拽的元素的上方按下是 开始进行拖拽
  /*
  obj.onmousedown = function (event){
  	
      //为了兼容IE8  下面这行代码表示你有这个就执行
      //浏览器有一个默认行为 就是你选种的元素有一个拖拽的效果 拉到导航栏中可以搜索的那个捕获ta
      //obj.setPointerCapture && obj.releasePointerCapture();
      
      div_droppagearea.setCaptue && div_droppagearea.setCaptue();
      //也是为了兼容IE8 window.event(IE8) 它的事件对象属性在window中
      event = event || window.event;
      //获取偏移量 保持鼠标的指针 不动  offsetLeft返回当前元素左上角相对于 HTMLElement.offsetParent节点的左边界偏移的像素值。
      //偏移量 offset
      var ox = event.offsetX;
      var oy = event.offsetY;
      var object_left = div_droppagearea.offsetLeft;
      var object_Top = div_droppagearea.offsetTop;
      var object_width = $(div_droppagearea).width();
      var object_height = $(div_droppagearea).height();
      var drapobj_width = $(obj).width();
      var drapobj_height = $(obj).height();
     
      //开始进行鼠标的移动 然后图片的移动
      */
      
      
      div_droppagearea.onmousemove = function (event) {
          event = event ||window.event;
          //当鼠标移动时 被拖拽元素跟移动
          //获取鼠标的二维坐标

          var left = event.offsetX + object_left - ox;
          var top = event.offsetY + object_Top-oy;
          
          if(left < object_left) {
          	left = object_left;
          	//console.log(1);
          } 
          if(top < object_Top) {
          	top = object_Top;
          	//console.log(2);
          }
          
          if ( left + drapobj_width > object_left + object_width ) {
          	left = object_left + object_width - drapobj_width;
          	//console.log(3);
          }
          
          if ( top + drapobj_height > object_Top + object_height ) {
          	top = object_Top + object_height - drapobj_height;
          	//console.log(4);
          }

          //修改图片的位置
          obj.style.left = left +"px";
          obj.style.top = top +"px";
          //console.log("mouse move : event.clientX(%d) event.clientY(%d) ox(%d) ox(%d) left(%d) top(%d)",event.offsetX,event.offsetY,ox,oy,left,top);
      };
      
      
      //移动完成后 鼠标的一个松开的事件
      /*
      div_droppagearea.onmouseup = function () {
          //当鼠标松开的时候 这个图片  被固定在当前的位置
          //取消鼠标的移动事件 和 ta被松开的事件
          div_droppagearea.onmousemove = null;
          div_droppagearea.onmouseup = null;
          //浏览器有一个默认行为 就是你选种的元素有一个拖拽的效果 拉到导航栏中可以搜索的那个
          //取消对ta的捕获
          div_droppagearea.releaseCapture && div_droppagearea.releaseCapture();
          //obj.releasePointerCapture && obj.releasePointerCapture();
      };
      */
      /*
       * 当我们拖拽一个网页中的内容时，浏览器会默认去搜索引擎中搜索内容，
       * 此时会导致拖拽功能的异常，这个是浏览器提供的默认行为，
       * 如果不希望发生这个行为，则可以通过return false来取消默认行为
       * 但是这招对IE8不起作用 IE8用这个obj.releaseCapture && obj.releaseCapture();
       */
      //return false;
    
 // };
  /*
  obj.onmouseup = function () {
      stopdropstamp();
      
  };
  
  div_pagearea.onmouseup = function () {
      stopdropstamp();
     
  };
  
  div_tools.onmouseup = function () {
      stopdropstamp();
      
  };
  */
}
//------------------------------------------------------------------------------------------
/*
function AutoResizeImage(imagedata,imagewidth,imageheight,maxWidth,maxHeight){
	
	maxHeight = maxHeight -60;//上面30px，下面30px
	var styleleft = 0;
	var styletop = 0;
	var isTF = false;
	var tempmaxwidth = maxWidth;
	var tempmaxHeight = maxHeight;
	if ( maxHeight >= imageheight &&  maxWidth >= imagewidth ) {

		tempmaxHeight = 0;
		tempmaxwidth = 0;
		styleleft = (maxWidth - imagewidth)/2;
		styletop = (maxHeight - imageheight) / 2;
		
	} else if ( maxHeight >= imageheight && maxWidth < imagewidth ) {
	
		tempmaxHeight = 0;
		styleleft = 0;
		styletop = (maxHeight - imageheight) / 2;
	} else if ( maxHeight < imageheight && maxWidth >= imagewidth ) {
		
		tempmaxwidth = 0;
		styleleft = (maxWidth - imagewidth)/2;
		styletop = 0;
	} else {
		
		tempmaxwidth = 0;
		isTF = true;
	}
	
	var hRatio;
	var wRatio;
	var Ratio = 1.0;
	var w = imagewidth;
	var h = imageheight;
	wRatio = maxWidth / w;
	hRatio = maxHeight / h;
	if (tempmaxwidth ==0 && tempmaxHeight==0){
		Ratio = 1;
	}else if (tempmaxwidth==0){//
		if (hRatio<1) Ratio = hRatio;
	}else if (tempmaxHeight==0){
		if (wRatio<1) Ratio = wRatio;
	}else if (wRatio<1 || hRatio<1){
		Ratio = (wRatio<=hRatio?wRatio:hRatio);
	}
	
	
	if (Ratio<1){
		w = w * Ratio;
		h = h * Ratio;
	} else {
		w = imagewidth;
		h = imageheight;
	}

	g_Ratio = Ratio;
	
	if ( isTF  ) {
		styleleft = (maxWidth - w)/2;
		styletop = (maxHeight - h) / 2;
	}

	div_zoompagearea.style.left = styleleft+"px";
    div_zoompagearea.style.top = "0px";
    div_zoompagearea.style.height = h+"px";
    div_zoompagearea.style.width =  w+"px";
    div_zoompagearea.style.display="";
    
    

	var arraylen = img_docpage_Array.length;
	var itemh = Math.floor(h/arraylen);

    for ( var v = 0; v < arraylen; v++) {
        img_docpage_Array[v].src = "data:image/png;base64,"+imagedata[v];
        img_docpage_Array[v].style.display="";
    }
    
    
    div_droppagearea.style.left = (styleleft-30)+"px";
    div_droppagearea.style.top = "0px";
    div_droppagearea.style.height = (h+60)+"px";//上面30px，下面30px
    div_droppagearea.style.width =  (w+60)+"px";
}
*/
//------------------------------------------------------------------------------------------
function AutoResizeImage(imagedata,imagewidth,imageheight,maxWidth,maxHeight)
{
		maxHeight=maxHeight-60;
		if ( g_Ratio == 0.0 ) {
				g_Ratio = (maxWidth-60) / imagewidth; 
				g_Ratio_MAX = (maxWidth-60) / imagewidth;
				g_Ratio_MIN = (maxWidth-60) /3/ imagewidth;
				g_Ratio = (g_Ratio_MAX - g_Ratio_MIN)/2+g_Ratio_MIN;
				g_Ratio_hundredth = (g_Ratio_MAX - g_Ratio_MIN)/100;
		} 
		
		//alert(g_Ratio);
		//alert(g_Ratio_MAX);
		//alert(g_Ratio_MIN);
	
		var w = imagewidth * g_Ratio;
		var h = imageheight * g_Ratio;
		
		var styleleft = (maxWidth - w)/2;
		var styletop = (maxHeight - h) / 2;
		
		div_zoompagearea.style.left = styleleft+"px";
    div_zoompagearea.style.top = "30px";
    div_zoompagearea.style.height = h+"px";
    div_zoompagearea.style.width =  w+"px";
    div_zoompagearea.style.display="";
    
    

		var arraylen = img_docpage_Array.length;
		
    for ( var v = 0; v < arraylen; v++) {
        img_docpage_Array[v].src = "data:image/png;base64,"+imagedata[v];
        img_docpage_Array[v].style.display="";
    }
    
    
    div_droppagearea.style.left = (styleleft-30)+"px";
    div_droppagearea.style.top = "0px";
    div_droppagearea.style.height = (h+60)+"px";//上面30px，下面30px
    div_droppagearea.style.width =  (w+60)+"px";
  
}
//------------------------------------------------------------------------------------------
//显示等待条
function showprogress()
{
	if ( div_progressbox != null && div_progressbox != undefined ) {
		div_progressbox.style.display="";
	} else {
	    alert("div_progressbox not defined");
    }
} 
//------------------------------------------------------------------------------------------
//隐藏等待条
function hideprogress()
{
	if ( div_progressbox != null && div_progressbox != undefined ) {
		div_progressbox.style.display="none";
	}
} 
//------------------------------------------------------------------------------------------
//打开文件
function AJAX_OpenFile(doctype,fileid,filedata)
{

    var jsondata = new Object();

    var filedatalen = filedata.length;
    var filedata_next = "";
    var issendnext = false;
    if ( filedatalen <= buffersize ) {
        jsondata.type = doctype;
        jsondata.isLast = true;
        jsondata.fileID = fileid;
        jsondata.fileData = filedata;
        issendnext = false;
    } else {
        jsondata.type = doctype;
        jsondata.isLast = false;
        jsondata.fileID = fileid;
        jsondata.fileData = filedata.substring(0,buffersize);
        filedata_next = filedata.substring(buffersize,filedatalen);
        issendnext = true;
    }


    $.ajax({

        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/openfile",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( issendnext ) {

                if ( data.status == 0 ) {
                    //alert(data.data.fileID);
                    AJAX_OpenFile(doctype,data.data.fileID,filedata_next);
                } else {
                    alert(data.message);
                    hideprogress();
                }

            } else {

                if ( data.status == 0 ) {
                    //alert(data.message);
                    currentpage = 0;
                    currfileid = data.data.fileID;
                    totalpagecount = data.data.pageCount;
                    docpage_1_width  = data.data.imageWidth;
                    docpage_1_height = data.data.imageHeight;
                    //alert(docpage_1_width+":"+docpage_1_height);

                    if ( text_totalpagecount != undefined ) {
                        text_totalpagecount.value = totalpagecount;
                    }

                    //img_docpage.style.display="";

                    AJAX_GetPage(currfileid,currentpage,true);
                    isOpenDoc = true;

                } else {
                    hideprogress();
                    alert(data.message);
                }

            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            alert(XMLHttpRequest.status);
            alert(XMLHttpRequest.readyState);
            alert(textStatus);
            alert(errorThrown);

        }
    });

}
//------------------------------------------------------------------------------------------
//打开本地文件
function AJAX_OpenFile_Local()
{

    var jsondata = new Object();
    jsondata.filePath = "aa";
      
    $.ajax({

        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        timeout:60000,
        url:"http://127.0.0.1:7655/docview/openfile_local",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( data.status == 0 ) {
                //alert(data.message);
                currentpage = 0;
                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }

            
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            alert(XMLHttpRequest.status);
            alert(XMLHttpRequest.readyState);
            alert(textStatus);
            alert(errorThrown);

        }
    });

}

function AJAX_OpenFile_Local_js_open(filepath)
{

    var jsondata = new Object();
    jsondata.filePath = filepath;
      
    $.ajax({

        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/openfile_local",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( data.status == 0 ) {
                //alert(data.message);
                currentpage = 0;
                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }

            
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            alert(XMLHttpRequest.status);
            alert(XMLHttpRequest.readyState);
            alert(textStatus);
            alert(errorThrown);

        }
    });

}
//------------------------------------------------------------------------------------------
//AJAX 获取页面数据
function AJAX_GetPage(fileid,pagecode,isShowMessage)
{
    var jsondata = new Object();
    jsondata.fileID = fileid;
    jsondata.pageCode = pagecode;
    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/getpage",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            hideprogress();
            if ( data.status == 0 ) {
                //alert(data.data.length);
								g_currpageimagedata = data.data;
                AutoResizeImage(g_currpageimagedata,docpage_1_width,docpage_1_height,pagearea_width,pagearea_height);
                input_gotopage.value = currentpage+1;
            } else {
            	if ( isShowMessage ) {
                alert(data.message);
              }
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
	            alert(XMLHttpRequest.status);
	            alert(XMLHttpRequest.readyState);
	            alert(textStatus);
	            alert(errorThrown);
	          }

        }
    });
}
//------------------------------------------------------------------------------------------
//关键字盖章
function keywordstamp_1(sealid)
{

    var keyworddata = text_keystamp.value;
    //keyworddata = keyworddata.replace(/^\s+|\s+$/g, "");
    //if (keyworddata == null || keyworddata == undefined || keyworddata == '') {
    //    alert("请您输入关键字");
    //    return;
    //}
    
    var jsondata = new Object();
    jsondata.fileID = currfileid;
    jsondata.keyWord = encodeURIComponent(keyworddata);
    jsondata.keyWordType = 0;
    jsondata.sealId = sealid;
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/keywordstamp",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( data.status == 0 ) {
                //alert(data.message);

                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
            }

        }
    });
}
//------------------------------------------------------------------------------------------
//关键字盖章
function keywordstamp_2(sealid)
{

    var keyworddata = text_keystamp.value;
    //keyworddata = keyworddata.replace(/^\s+|\s+$/g, "");
    //if (keyworddata == null || keyworddata == undefined || keyworddata == '') {
    //    alert("请您输入关键字");
    //
    //    return;
    //}
  
    var jsondata = new Object();
    jsondata.fileID = currfileid;
    jsondata.keyWord = encodeURIComponent(keyworddata);
    jsondata.keyWordType = 1;
    jsondata.sealId = sealid;
    showprogress();


    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/keywordstamp",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( data.status == 0 ) {
                //alert(data.message);

                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
            }

        }
    });
}
//------------------------------------------------------------------------------------------
//显示等待条
function showkeywordstamp()
{
	if ( div_keywordstampbox != null && div_keywordstampbox != undefined ) {
		div_keywordstampbox.style.display="";
	}
} 
//------------------------------------------------------------------------------------------
//隐藏等待条
function hidekeywordstamp()
{
	if ( div_keywordstampbox != null && div_keywordstampbox != undefined ) {
		div_keywordstampbox.style.display="none";
	}
} 
//------------------------------------------------------------------------------------------
//显示验证签名结果


function showVerifyResult(index)
{
    if ( div_verifyresultbox != null && div_verifyresultbox != undefined && verifylist != null && verifylist != undefined ) {
    	
    		if ( verifylist.length <= 0 ) {
    			alert("没有验证结果！");
    			return;
    		}
    		
    		text_verifynumber.value = (index+1)+"/"+verifylist.length;
        img_verifyImage.src = "data:image/png;base64,"+(verifylist[index].verify == true ? verify_ok_imagedata : verify_error_imagedata); //verify_error_imagedata verify_ok_imagedata
        text_verify.value = verifylist[index].verify?"签章有效":"签章无效";
        text_verify_message1.value = "签章人："+verifylist[index].certCN;
        /*
        if ( sealname.length <= 15 ) {
            text_verify_message2.value = "印章名称：" + sealname;
        } else {
        	
            if ( sealname.length > 30 ) {
                text_verify_message2.value = "印章名称：" + sealname.substring(0, 15);
                text_verify_message3.value = sealname.substring(15, 28)+"...";
            } else {
                text_verify_message2.value = "印章名称：" + sealname.substring(0, 15);
                text_verify_message3.value = sealname.substring(15, sealname.length);
            }
            
        }
        */
        text_verify_message4.value = "起始时间："+verifylist[index].signDate;
        //text_verify_message5.value = "结束时间："+endtime;
        text_verify_message6.value = "签名算法："+verifylist[index].signAlg;
	

		div_verifyresultbox.style.display="";
	}
}
//------------------------------------------------------------------------------------------
//创建验证div
function createverifybox()
{
    div_verifyresultbox = document.createElement("div");
    div_verifyresultbox.style.cssText+= "position: absolute;left:"+((width-300)/2)+"px;top:"+((height-300)/2-40-20)+"px;width: 300px;height: 300px;border: 1px solid #F2F2F2;background-color:#F2F2F2;margin: 0 auto;margin-top: 100px;z-index:10001;";
    this.id.appendChild(div_verifyresultbox);
    
    
    var div_verifytools = document.createElement("div");
    div_verifytools.style.cssText+= "position: relative;left:0px;top:10px;width:100%;height:40px;border: 1px solid #F2F2F2;background-color:#F2F2F2;margin: 0 auto;margin-top: 0px;z-index:10001;float:left";
    div_verifyresultbox.appendChild(div_verifytools);
    
    
    var button_verifyprevious = document.createElement("input");
    button_verifyprevious.style.cssText+="position:relative;left:6px;top:0px;width:50px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    button_verifyprevious.type = "button";
    button_verifyprevious.value = "上一条";
    button_verifyprevious.onclick=function () {
    	verifylist_index = verifylist_index - 1;
    	if ( verifylist_index <= 0 ) {
    		verifylist_index = 0;
    	}
    	showVerifyResult(verifylist_index);
    };
    div_verifytools.appendChild(button_verifyprevious);
    
    
    
    text_verifynumber = document.createElement("input");
    text_verifynumber.style.cssText+="position:relative;left:"+((300-100-100)/2)+"px;top:4px;width:100px;height:24px;line-height:24px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    text_verifynumber.type = "text";
    text_verifynumber.value = "1/2";
    text_verifynumber.readOnly = true;
    text_verifynumber.disabled = true;
    div_verifytools.appendChild(text_verifynumber);
    
    var button_verifynext = document.createElement("input");
    button_verifynext.style.cssText+="position:relative;left:"+(-6)+"px;top:0px;width:50px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:right";
    button_verifynext.type = "button";
    button_verifynext.value = "下一条";
    button_verifynext.onclick=function () {
    	verifylist_index = verifylist_index + 1;
    	if ( verifylist_index >= verifylist.length ) {
    		verifylist_index = verifylist.length-1;
    	}
    	showVerifyResult(verifylist_index);
    };
    div_verifytools.appendChild(button_verifynext);
    
    
    

    img_verifyImage=document.createElement("img");
    img_verifyImage.style.cssText+="position:relative;left:16px;top:30px;width:24px;height:24px;z-index:9999;float:left";
    img_verifyImage.src = "data:image/png;base64,"+verify_ok_imagedata; //verify_error_imagedata verify_ok_imagedata
    div_verifyresultbox.appendChild(img_verifyImage);
    
    text_verify = document.createElement("input");
    text_verify.style.cssText+="position:relative;left:26px;top:30px;width:200px;height:24px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:left;float:left";
    text_verify.type = "text";
    text_verify.value = "签章有效";
    text_verify.readOnly = true;
    text_verify.disabled = true;
    div_verifyresultbox.appendChild(text_verify);
    
    var img_ge=document.createElement("img");
    img_ge.style.cssText+="position:relative;left:0px;top:44px;width:300px;height:1px;z-index:9999;float:left";
    img_ge.src = "data:image/png;base64,"+fenge_imagedata;
    div_verifyresultbox.appendChild(img_ge);
    
    
    text_verify_message1 = document.createElement("input");
    text_verify_message1.style.cssText+="position:relative;left:16px;top:70px;width:280px;height:24px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:left;float:left";
    text_verify_message1.type = "text";
    text_verify_message1.value = "签章人：张凤飞飞 202108197703036651";
    text_verify_message1.readOnly = true;
    text_verify_message1.disabled = true;
    div_verifyresultbox.appendChild(text_verify_message1);
    
    /*
    
    text_verify_message2 = document.createElement("input");
    text_verify_message2.style.cssText+="position:relative;left:10px;top:60px;width:280px;height:24px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:left;float:left";
    text_verify_message2.type = "text";
    text_verify_message2.value = "印章名称：祥云测试用章祥云测试用章祥云测试用章祥云测试用章祥云测试用章";
    text_verify_message2.readOnly = true;
    text_verify_message2.disabled = true;
    div_verifyresultbox.appendChild(text_verify_message2);
    
    
    text_verify_message3 = document.createElement("input");
    text_verify_message3.style.cssText+="position:relative;left:76px;top:60px;width:204px;height:24px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:left;float:left";
    text_verify_message3.type = "text";
    text_verify_message3.value = "";
    text_verify_message3.readOnly = true;
    text_verify_message3.disabled = true;
    div_verifyresultbox.appendChild(text_verify_message3);
    */
    
    text_verify_message4 = document.createElement("input");
    text_verify_message4.style.cssText+="position:relative;left:16px;top:80px;width:280px;height:24px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:left;float:left";
    text_verify_message4.type = "text";
    text_verify_message4.value = "起始时间：2020-01-09 12:55:56";
    text_verify_message4.readOnly = true;
    text_verify_message4.disabled = true;
    div_verifyresultbox.appendChild(text_verify_message4);
   	/*
    text_verify_message5 = document.createElement("input");
    text_verify_message5.style.cssText+="position:relative;left:10px;top:60px;width:280px;height:24px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:left;float:left";
    text_verify_message5.type = "text";
    text_verify_message5.value = "结束时间：2020-01-09 12:55:56";
    text_verify_message5.readOnly = true;
    text_verify_message5.disabled = true;
    div_verifyresultbox.appendChild(text_verify_message5);
    */
    
    text_verify_message6 = document.createElement("input");
    text_verify_message6.style.cssText+="position:relative;left:16px;top:90px;width:280px;height:24px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:left;float:left";
    text_verify_message6.type = "text";
    text_verify_message6.value = "签名算法：SM2-SM3";
    text_verify_message6.readOnly = true;
    text_verify_message6.disabled = true;
    div_verifyresultbox.appendChild(text_verify_message6);
    
    var button_verifyresultbox = document.createElement("input");
    button_verifyresultbox.style.cssText+="position:relative;left:110px;top:120px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:10002;border:1px solid #83C0EF;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    button_verifyresultbox.type = "button";
    button_verifyresultbox.value = "关闭";
    button_verifyresultbox.onclick=function () {
        if ( div_verifyresultbox != null && div_verifyresultbox != undefined ) {
					div_verifyresultbox.style.display="none";
				}
    };
    div_verifyresultbox.appendChild(button_verifyresultbox);
    div_verifyresultbox.style.display="none";
} 
//------------------------------------------------------------------------------------------
//显示是否在该位置盖章
function showposttionstampbox()
{
	
	if ( div_postionstampbox != null && div_postionstampbox != undefined ) {
		div_postionstampbox.style.display="";
	}
} 
//------------------------------------------------------------------------------------------
//隐藏是否在该位置盖章
function hideposttionstampbox()
{
	if ( div_postionstampbox != null && div_postionstampbox != undefined ) {
		div_postionstampbox.style.display="none";
	}
} 
//------------------------------------------------------------------------------------------
//提示 是否在该位置盖章
function createPostionStampBox()
{
	
	div_postionstampbox = document.createElement("div");
    div_postionstampbox.style.cssText+= "position: absolute;left:"+((width-300)/2)+"px;top:"+((height-100)/2-40-20)+"px;width: 300px;height: 100px;border: 1px solid #F2F2F2;background-color:#F2F2F2;margin: 0 auto;margin-top: 100px;z-index:10001;";
    div_postionstampbox.innerHTML="<div style='position:relative;top:10px; border:none;background-color:#F2F2F2; margin:0 auto;width:260px;height:40px' align='center'><hi style='font-size:14px' >您是否在该位置盖章？</hi><br></div>";
    this.id.appendChild(div_postionstampbox);

    var button_choice_1 = document.createElement("input");

    button_choice_1.style.cssText+="position:relative;left:26px;top:20px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:10002;border:1px solid #83C0EF;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    button_choice_1.type = "button";
    button_choice_1.value = "是";
    button_choice_1.onclick=function () {
    		hideposttionstampbox();
        stopdropstamp();
	  		signstamp_positon();
	  		//先请求二维码，再盖章
        //getSealQRCode();
    };
    div_postionstampbox.appendChild(button_choice_1);
    
    var button_choice_2 = document.createElement("input");

    button_choice_2.style.cssText+="position:relative;left:28px;top:20px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:10002;border:1px solid #83C0EF;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    button_choice_2.type = "button";
    button_choice_2.value = "否";
    button_choice_2.onclick=function () {
        hideposttionstampbox();
        dragImg(img_stamp);
        
    };
    div_postionstampbox.appendChild(button_choice_2);

    var button_choice_3 = document.createElement("input");

    button_choice_3.style.cssText+="position:relative;left:30px;top:20px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:10002;border:1px solid #83C0EF;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    button_choice_3.type = "button";
    button_choice_3.value = "暂时不盖章";
    button_choice_3.onclick=function () {
        hideposttionstampbox();
        stopdropstamp();
        hidedropstamp();
    };
    div_postionstampbox.appendChild(button_choice_3);
    hideposttionstampbox();
}
//------------------------------------------------------------------------------------------
function createQRCode()
{
	div_qrcodebox = document.createElement("div");
  div_qrcodebox.style.cssText+= "position: absolute;left:"+((width-300)/2)+"px;top:"+((height-300)/2-40-20)+"px;width: 300px;height: 340px;border: 1px solid #F2F2F2;background-color:#F2F2F2;margin: 0 auto;margin-top: 100px;z-index:10001;";
  this.id.appendChild(div_qrcodebox);
  
  img_qrcode=document.createElement("img");
  img_qrcode.style.cssText+="position:relative;left:10px;top:10px;width:280px;height:280px;z-index:9999;float:left";
  img_qrcode.src = "data:image/png;base64,"+verify_ok_imagedata; //verify_error_imagedata verify_ok_imagedata
  div_qrcodebox.appendChild(img_qrcode);
  
  var button_qrcode_close = document.createElement("input");
  button_qrcode_close.style.cssText+="position:relative;left:110px;top:20px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:10002;border:1px solid #83C0EF;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
  button_qrcode_close.type = "button";
  button_qrcode_close.value = "关闭";
  button_qrcode_close.onclick=function () {
      if ( div_qrcodebox != null && div_qrcodebox != undefined ) {
            div_qrcodebox.style.display="none";
          stopqrcodetimer();
            hideposttionstampbox();
            dragImg(img_stamp);
      }
  };
  div_qrcodebox.appendChild(button_qrcode_close);
  div_qrcodebox.style.display="none";
		
}
//------------------------------------------------------------------------------------------
function showQRCode(qrcodedata)
{
	if ( qrcodedata == null || qrcodedata == undefined ) {
		alert("二维码图片数据不能为空！");
		return;
	}
	if ( div_qrcodebox != null && div_qrcodebox != undefined ) {
		img_qrcode.src = "data:image/png;base64,"+qrcodedata;
		div_qrcodebox.style.display="";
	}
}
//------------------------------------------------------------------------------------------
function hideQRCode()
{
	if ( div_qrcodebox != null && div_qrcodebox != undefined ) {
		div_qrcodebox.style.display="none";
	}
}
//------------------------------------------------------------------------------------------
/******************************************对外提供函数************************************/
//------------------------------------------------------------------------------------------

//function setID(id,isShowToolbar,param_callback_applyqrcode,param_callback_verify,param_callback_getsealid,param_callback_getSignFileData)
function setID(id,isShowToolbar,param_callback_applyqrcode,param_callback_verify,param_callback_getSignFileData)
{
    if ( this.id != null && this.id != undefined ) {
        return;
    }
    this.id=id;

    func_callback_applyqrcode = param_callback_applyqrcode;
    func_callback_verify = param_callback_verify;
    func_callback_getsignfiledata = param_callback_getSignFileData;
    func_callback_getsealid = null;
    //func_callback_getsealid = param_callback_getsealid;
    
    //var sheet = document.createStyleSheet();
		//sheet.addRule('div::-webkit-scrollbar','width:4px');
		//sheet.addRule('div::-webkit-scrollbar-track','-webkit-box-shadow:inset 0 0 6px rgba(255,255,255,0.5)');
		//sheet.addRule('div::-webkit-scrollbar-thumb','background:rgba(0,0,0,0.1)');
		//sheet.addRule('div::-webkit-scrollbar-thumb','-webkit-box-shadow:inset 0 0 6px rgba(39,167,148)');
		//sheet.addRule('div::-webkit-scrollbar-thumb:window-inactive','background:rgba(255,0,0,0.4)');
		
		//window.style="body{background-color:blue;";
		//document.createStyleSheet("javascript:style");
		/*
		if(document.all){ // document.createStyleSheet(url)
			alert("aa");
      window.style="div::-webkit-scrollbar {width:10px;} div::-webkit-scrollbar-track {webkit-box-shadow:inset 0 0 6px rgba(255,255,255,0.5);} div::-webkit-scrollbar-thumb {background:rgba(0,0,0,0.1);-webkit-box-shadow:inset 0 0 6px rgba(39,167,148);} div::-webkit-scrollbar-thumb:window-inactive {background:rgba(255,0,0,0.4);}"; 
      document.createStyleSheet("javascript:style"); 
    }else{ 
    	alert("bb");
			var style = document.createElement('style'); 
	    style.type = 'text/css'; 
	    style.innerHTML="::-webkit-scrollbar {width:10px;} ::-webkit-scrollbar-track {webkit-box-shadow:inset 0 0 6px rgba(255,255,255,0.5);} ::-webkit-scrollbar-thumb {background:rgba(0,0,0,0.1);-webkit-box-shadow:inset 0 0 6px rgba(39,167,148);} ::-webkit-scrollbar-thumb:window-inactive {background:rgba(255,0,0,0.4);}"; 
	    document.getElementsByTagName('HEAD').item(0).appendChild(style); 
    }
    */
    
    width = $(id).width();
    height = $(id).height();
    
    
    
    div_progressbox = document.createElement("div");
    div_progressbox.style.cssText+= "position: absolute;left:"+((width-100)/2)+"px;top:"+((height-40)/2-40-20)+"px;width: 200px;height: 40px;border: 1px solid #C8C8C8;background: white;margin: 0 auto;margin-top: 100px;z-index:10101;";
    this.id.appendChild(div_progressbox);
    
    text_progresstext = document.createElement("input");
    
    text_progresstext.style.cssText+="position:relative;left:0px;top:10px;width:90%;height:20px;line-height:20px;padding:0;background-color:white;z-index:10101;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    text_progresstext.type = "text";
    text_progresstext.value = "请您稍等，正在请求数据...";
    text_progresstext.readOnly = true;
    text_progresstext.disabled = true;
    div_progressbox.appendChild(text_progresstext);
    hideprogress();

    div_keywordstampbox = document.createElement("div");
    div_keywordstampbox.style.cssText+= "position: absolute;left:"+((width-300)/2)+"px;top:"+((height-130)/2-40-20)+"px;width: 300px;height: 130px;border: 1px solid #F2F2F2;background-color:#F2F2F2;margin: 0 auto;margin-top: 100px;z-index:10001;";
    div_keywordstampbox.innerHTML="<div style='position:relative;top:10px; border:none;background-color:#F2F2F2; margin:0 auto;width:260px;height:70px' ><hi style='font-size:14px'>关键字盖章：</hi><br><hi style='font-size:14px'>(1):在最后一个关键字位置盖章。</hi><br><hi style='font-size:14px'>(2):在文档中所有包含关键字的位置盖章。</hi><br></div>";
    this.id.appendChild(div_keywordstampbox);

    var button_choice_1 = document.createElement("input");

    button_choice_1.style.cssText+="position:relative;left:66px;top:20px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:10002;border:1px solid #83C0EF;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    button_choice_1.type = "button";
    button_choice_1.value = "选择 (1)";
    button_choice_1.onclick=function () {
        hidekeywordstamp();
        add_Seal_Type = 21;
        getSealQRCode();

    };
    div_keywordstampbox.appendChild(button_choice_1);
    
    var button_choice_2 = document.createElement("input");

    button_choice_2.style.cssText+="position:relative;left:68px;top:20px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:10002;border:1px solid #83C0EF;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    button_choice_2.type = "button";
    button_choice_2.value = "选择 (2)";
    button_choice_2.onclick=function () {
        hidekeywordstamp();
        add_Seal_Type = 22;
        getSealQRCode();

    };
    div_keywordstampbox.appendChild(button_choice_2);
    hidekeywordstamp();
    
    createverifybox();
    createPostionStampBox();
    createQRCode();

    
    //工具栏
    div_tools = document.createElement("div");  
    div_tools.style.cssText+="position:relative;left:0px;top:0px;width:100%;height:40px;background-color:#F2F2F2;border:solid 1px;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;";
    this.id.appendChild(div_tools);
    //文档显示区
    div_pagearea = document.createElement("div");  
    div_pagearea.style.cssText+="overflow-y:auto;overflow-x:hidden;position:relative;left:0px;top:0px;width:100%;background-color:#999988;border:solid 1px;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;";
    div_pagearea.style.height = height - 40 + "px";
    this.id.appendChild(div_pagearea);
    
    //工具栏子
    var div_toolitem = document.createElement("div");
    div_toolitem.style.cssText+="position:relative;left:0px;top:5px;width:100%;height:30px;background-color:#F2F2F2;border:solid 1px;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;";
    div_tools.appendChild(div_toolitem);
    
    
    
    
    //goto 页
    input_gotopage = document.createElement("input");
    input_gotopage.style.cssText+="position:relative;left:5px;top:0px;width:30px;height:30px;line-height:30px;padding:0;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    input_gotopage.title = "跳转页面";
    //只能输入数字
    input_gotopage.onkeyup= function(){
		   var c=$(this);
		   if(/[^\d]/.test(c.val())){//替换非数字字符
		    var temp_amount=c.val().replace(/[^\d]/g,'');
		    $(this).val(temp_amount);
		   }
   	};    
   
    //只能输入数字，防止输入英文时闪烁
    input_gotopage.onkeydown = function (event) {
		    var event = window.event || arguments.callee.caller.arguments[0];
		    var currKey=0,event=event||event; currKey=event.keyCode||event.which||event.charCode;
		    
		    if (currKey == 13){
		    	gotopage(input_gotopage.value);
		    }
		    
		    if ((currKey >= 48 && currKey <= 57) || currKey == 46 || currKey == 8 || (currKey >= 37 && currKey <= 40)  ) {   
		    
		        event.returnValue = true;    
		    }else {    
		    	
		        event.returnValue = false;    
		    } 
		    
		};
    div_toolitem.appendChild(input_gotopage);
    
    //总页数
    text_totalpagecount = document.createElement("input");
    
    text_totalpagecount.style.cssText+="position:relative;left:10px;top:0px;width:30px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    text_totalpagecount.type = "text";
    text_totalpagecount.value = totalpagecount;
    text_totalpagecount.readOnly = true;
    text_totalpagecount.disabled = true;
    text_totalpagecount.title = "总页数";
    div_toolitem.appendChild(text_totalpagecount);
    
    //分隔 
    var img_fenge=document.createElement("img");
    img_fenge.style.cssText+="position:relative;left:20px;top:0px;width:1px;height:30px;z-index:9999;float:left";
    img_fenge.src = "data:image/png;base64,"+fenge_imagedata;
    div_toolitem.appendChild(img_fenge);
    
    //上一页
    //img_previouspage=document.createElement("img");
    //img_previouspage.style.cssText+="position:relative;left:30px;top:0px;width:14px;height:26px;z-index:9999;float:left";
    //img_previouspage.src = "data:image/png;base64,"+previouspage_imagedata;
    //img_previouspage.onclick=function () {
    //	previouspage();
    //};
    //div_toolitem.appendChild(img_previouspage);
    
    var text_previouspage = document.createElement("input");
    
    text_previouspage.style.cssText+="position:relative;left:30px;top:0px;width:50px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    text_previouspage.type = "button";
    text_previouspage.value = "上一页";
    //text_previouspage.readOnly = true;
    //text_previouspage.disabled = true;
    text_previouspage.onclick=function () {
    	previouspage();
    };
    div_toolitem.appendChild(text_previouspage);
    
    var text_nextpage = document.createElement("input");
    text_nextpage.style.cssText+="position:relative;left:30px;top:0px;width:50px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:left";
    text_nextpage.type = "button";
    text_nextpage.value = "下一页";
    //text_nextpage.readOnly = true;
    //text_nextpage.disabled = true;
    text_nextpage.onclick=function () {
    	nextpage();
    };
    div_toolitem.appendChild(text_nextpage);
    
    //分隔 
    var img_fenge_1=document.createElement("img");
    img_fenge_1.style.cssText+="position:relative;left:40px;top:0px;width:1px;height:30px;z-index:9999;float:left";
    img_fenge_1.src = "data:image/png;base64,"+fenge_imagedata;
    div_toolitem.appendChild(img_fenge_1);
    
    
    img_zoomout = document.createElement("img");
    img_zoomout.style.cssText+="position:relative;left:60px;top:5px;width:20px;height:20px;z-index:9999;float:left";
    img_zoomout.src = "data:image/png;base64,"+zoomout_imagedata;
    img_zoomout.title = "放大显示";
    img_zoomout.onclick=function () {
    	zoomout();
    };
    div_toolitem.appendChild(img_zoomout);
    
    img_zoomin = document.createElement("img");
    img_zoomin.style.cssText+="position:relative;left:70px;top:5px;width:20px;height:20px;z-index:9999;float:left";
    img_zoomin.src = "data:image/png;base64,"+zoomin_imagedata;
    img_zoomin.title = "缩小显示";
    img_zoomin.onclick=function () {
    	zoomin();
    };
    div_toolitem.appendChild(img_zoomin);
    
    //分隔 
    var img_fenge_2=document.createElement("img");
    img_fenge_2.style.cssText+="position:relative;left:90px;top:0px;width:1px;height:30px;z-index:9999;float:left";
    img_fenge_2.src = "data:image/png;base64,"+fenge_imagedata;
    div_toolitem.appendChild(img_fenge_2);
    
    img_openfile_local = document.createElement("img");
    img_openfile_local.style.cssText+="position:relative;left:110px;top:5px;width:20px;height:20px;z-index:9999;float:left";
    img_openfile_local.src = "data:image/png;base64,"+openfile_imagedata;
    img_openfile_local.title = "打开本地文档";
    img_openfile_local.onclick=function () {
    	openfile_local();
    };
    div_toolitem.appendChild(img_openfile_local);
    
    img_savefile_local = document.createElement("img");
    img_savefile_local.style.cssText+="position:relative;left:120px;top:5px;width:20px;height:20px;z-index:9999;float:left";
    img_savefile_local.src = "data:image/png;base64,"+savefile_imagedata;
    img_savefile_local.title = "保存文档到本地";
    img_savefile_local.onclick=function () {
    	savefile_local();
    };
    div_toolitem.appendChild(img_savefile_local);
    
    img_printfile_local = document.createElement("img");
    img_printfile_local.style.cssText+="position:relative;left:130px;top:5px;width:20px;height:20px;z-index:9999;float:left";
    img_printfile_local.src = "data:image/png;base64,"+printfile_imagedata;
    img_printfile_local.title = "打印文档";
    img_printfile_local.onclick=function () {
    	printfile_local();
    };
    div_toolitem.appendChild(img_printfile_local);
    
    //下一页
    //img_nextpage=document.createElement("img");
    //img_nextpage.style.cssText+="position:relative;left:40px;top:0px;width:14px;height:26px;z-index:9999;float:left";
    //img_nextpage.src = "data:image/png;base64,"+nextpage_imagedata;
   // img_nextpage.onclick=function () {
    //	nextpage();
    //};
    //div_toolitem.appendChild(img_nextpage);
    
    
    
    
    //关闭文档
    img_closefile=document.createElement("img");
    img_closefile.style.cssText+="position:relative;left:-5px;top:0px;width:30px;height:30px;z-index:9999;float:right";
    img_closefile.src = "data:image/png;base64,"+closefile_imagedata;
    img_closefile.title = "关闭文件";
    img_closefile.onclick=function () {
    	closefile();
    };
    div_toolitem.appendChild(img_closefile);
    
    //验证印章
    img_verify=document.createElement("img");
    img_verify.style.cssText+="position:relative;left:-15px;top:0px;width:26px;height:30px;z-index:9999;float:right";
    img_verify.src = "data:image/png;base64,"+verify_imagedata;
    img_verify.title = "验证文档";
    img_verify.onclick=function () {
    	verify();
    };
    div_toolitem.appendChild(img_verify);
    
    //骑缝章
    img_ridestamp=document.createElement("img");
    img_ridestamp.style.cssText+="position:relative;left:-25px;top:0px;width:26px;height:30px;z-index:9999;float:right";
    img_ridestamp.src = "data:image/png;base64,"+ridestamp_imagedata;
    img_ridestamp.title = "盖骑缝章";
    img_ridestamp.onclick=function () {
    	
    	ridestamp();
    };
    div_toolitem.appendChild(img_ridestamp);
    
    //位置盖章
    img_posstamp=document.createElement("img");
    img_posstamp.style.cssText+="position:relative;left:-35px;top:0px;width:30px;height:30px;z-index:9999;float:right";
    img_posstamp.src = "data:image/png;base64,"+posstamp_imagedata;
    img_posstamp.title = "位置盖章";
    img_posstamp.onclick=function () {
    	posstamp();
    };
    div_toolitem.appendChild(img_posstamp);
    
    //关键字盖章
    img_keystamp=document.createElement("img");
    img_keystamp.style.cssText+="position:relative;left:-45px;top:0px;width:30px;height:30px;z-index:9999;float:right";
    img_keystamp.src = "data:image/png;base64,"+keystamp_imagedata;
    img_keystamp.title = "关键字盖章";
    img_keystamp.onclick=function () {
    	keystamp();
    };
    div_toolitem.appendChild(img_keystamp);
    
    //关键字盖章
    text_keystamp = document.createElement("input");
    text_keystamp.style.cssText+="position:relative;left:-55px;top:0px;width:150px;height:30px;line-height:30px;padding:0;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:right";
    text_keystamp.placeholder = "请输入盖章关键字";
    div_toolitem.appendChild(text_keystamp);



    var text_usbkey = document.createElement("input");
    text_usbkey.style.cssText+="position:relative;left:-65px;top:0px;width:80px;height:30px;line-height:30px;padding:0;background-color:#F2F2F2;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:right";
    text_usbkey.type = "text";
    text_usbkey.value = "使用USBKey";
    text_usbkey.readOnly = true;
    text_usbkey.disabled = true;
    div_toolitem.appendChild(text_usbkey);

    checkbox_usbkey = document.createElement("input");
    checkbox_usbkey.type = "checkbox";
    checkbox_usbkey.style.cssText+="position:relative;left:-62px;top:3px;width:20px;height:20px;line-height:20px;padding:0;z-index:9999;border:none;box-shadow: 0px 0px 0px 0px;text-align:center;float:right";
    checkbox_usbkey.value = "使用USBKey";
    div_toolitem.appendChild(checkbox_usbkey);
    
    
    
    //下一页
    var img_nextpage2=document.createElement("img");
    img_nextpage2.style.cssText+="position:absolute;left:"+(width-50)+"px;top:"+((height-40)/2)+"px;width:15px;height:30px;z-index:10100";
    img_nextpage2.src = "data:image/png;base64,"+nextpage_imagedata;
    img_nextpage2.title = "下一页";
    img_nextpage2.onclick=function () {
    	nextpage();
    };
    this.id.appendChild(img_nextpage2);
    
    //上一页
    var img_previouspage2=document.createElement("img");
    img_previouspage2.style.cssText+="position:absolute;left:50px;top:"+((height-40)/2)+"px;width:15px;height:30px;z-index:10100";
    img_previouspage2.src = "data:image/png;base64,"+previouspage_imagedata;
    img_previouspage2.title = "上一页";
    img_previouspage2.onclick=function () {
    	previouspage();
    };
    this.id.appendChild(img_previouspage2);
    
    
    
    div_pageshowarea = document.createElement("div");
    div_pageshowarea.style.cssText+="position:relative;left:50px;top:0px;width:"+(width-100)+"px;background-color:#999988;border:none;z-index:9999;box-shadow: 0px 0px 0px 0px;margin:0px;padding:0px;margin:0px";
    //div_pageshowarea.style.cssText+="position:relative;left:50px;top:0px;width:"+(width-100)+"px;background-color:#999988;border:none;z-index:9999;box-shadow: 0px 0px 0px 0px;margin:0px;padding:0px;margin:0px";
    div_pageshowarea.style.height = height - 40 + "px";
    //div_pageshowarea.className = "scrollable";
    div_pagearea.appendChild(div_pageshowarea);
    
    pagearea_width = $(div_pageshowarea).width();
    pagearea_height = $(div_pageshowarea).height();

    div_zoompagearea = document.createElement("div");
    div_zoompagearea.style.cssText+="position:relative;left:0px;top:0px;background-color:#999988;border:none;z-index:9999;box-shadow: 0px 0px 0px 0px;margin:0px;padding:0px;margin:0px";
    div_zoompagearea.style.width = pagearea_width + "px";
    div_zoompagearea.style.height = pagearea_height + "px";
    //div_zoompagearea.className = "scrollable";
    div_pageshowarea.appendChild(div_zoompagearea);


    for ( var v = 0; v < img_docpage_Array_Count; v++ ) {
        img_docpage_Array[v] = document.createElement("img");
      	img_docpage_Array[v].style.cssText+="vertical-align:top;position:relative;left:0px;top:0px;width:100%;height:"+100/img_docpage_Array_Count+"%;z-index:-1;border:none;padding:0px;margin:0px;box-shadow: 0px 0px 0px 0px";
        
        //img_docpage_Array[v].style.width = pagearea_width + "px";
    	  //img_docpage_Array[v].style.height = parseInt(pagearea_height/10) + "px";
        div_zoompagearea.appendChild(img_docpage_Array[v]);
        img_docpage_Array[v].style.display="none";
    }


		div_droppagearea = document.createElement("div");
    //div_droppagearea.style.cssText+="background:url(0) no-repeat;position:absolute;left:0px;top:0px;width:100%;height:100%;background-color:rgba(255,255,255,0);border:solid 1px;z-index:10000;box-shadow: 0px 0px 0px 0px;margin:0px;padding:0px;margin:0px;float:top";
    div_droppagearea.style.cssText+="filter:alpha(opacity=0);background:url(0) no-repeat;position:absolute;left:0px;top:0px;border:none;z-index:10000;box-shadow: 0px 0px 0px 0px;margin:0px;padding:0px;margin:0px;float:top";
    div_droppagearea.style.width = pagearea_width + "px";
    div_droppagearea.style.height = pagearea_height + "px";
    div_pageshowarea.appendChild(div_droppagearea);
		
    
  
    img_stamp =document.createElement("img");
    img_stamp.style.cssText+="position:absolute;left:0px;top:0px;width:30;height:30;z-index:10100";
    img_stamp.src = "data:image/png;base64,"+stamp_imagedata;
    div_pageshowarea.appendChild(img_stamp);
    hidedropstamp();
    
    
    
    
}
//------------------------------------------------------------------------------------------
//显示文件
function openFile(type,fileData)
{
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
    if ( this.id == null || this.id == undefined ) {
        return;
    }
    text_keystamp.value = "";
    currentpage = 0;
    g_Ratio = 0.0;
    showprogress();
    AJAX_OpenFile(type,"",fileData);
}
//------------------------------------------------------------------------------------------
//关闭文件
function closefile(){
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
	if ( div_pageshowarea == null || div_pageshowarea != undefined ) {
		stopdropstamp();
        hidedropstamp();
	    div_zoompagearea.style.display="none";
        currentpage = 0;
		totalpagecount = 0;
		input_gotopage.value = "";

        text_keystamp.value = "";
        getFileData();
	}
	isOpenDoc = false;
}
//------------------------------------------------------------------------------------------
//上一页
function previouspage(){
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
    if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
    currentpage = currentpage - 1;
    if ( currentpage < 0 ) {
    	currentpage = 0;
    }

    AJAX_GetPage(currfileid,currentpage,true);

}
//------------------------------------------------------------------------------------------
//下一页
function nextpage(){
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
    currentpage = currentpage + 1;
    if ( currentpage >= totalpagecount ) {
    	currentpage = totalpagecount - 1;
    }

    AJAX_GetPage(currfileid,currentpage,true);
}
//------------------------------------------------------------------------------------------
function showPage(pageIndex)
{
	gotopage(pageIndex);
}
//------------------------------------------------------------------------------------------
//goto页
function gotopage(pagenum){
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
	  if ( pagenum > 0 && pagenum <= totalpagecount ) {
	    currentpage = pagenum-1;
	    AJAX_GetPage(currfileid,currentpage,true);
	  }
}
//------------------------------------------------------------------------------------------
//位置盖章
function posstamp(){

    stopqrcodetimer();
    if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
    add_Seal_Type = 1;
    img_stamp.style.display="";
  	//img_stamp.style.left = div_zoompagearea.offsetLeft+"px";
  	//img_stamp.style.top = div_zoompagearea.offsetTop+"px";
  	img_stamp.style.left =  div_zoompagearea.offsetLeft + $(div_droppagearea).width()-$(img_stamp).width()-30+"px";
    img_stamp.style.top =  div_zoompagearea.offsetTop+"px";
  	dragImg(img_stamp);
  	
}
//------------------------------------------------------------------------------------------
//关键字盖章
function keystamp(){

    if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
    //alert("keystamp");
    //showprogress();

    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();

    var keyworddata = text_keystamp.value;
    keyworddata = keyworddata.replace(/^\s+|\s+$/g, "");
    if (keyworddata == null || keyworddata == undefined || keyworddata == '') {
        alert("请您输入关键字");
        return;
    }
    
    keywordstamp_1("");

//关键字盖章选择框
/*
    if (checkbox_usbkey.checked) {
        var jsondata = new Object();
        jsondata.fileID = currfileid;
        showprogress();

        $.ajax({
            type:"GET",
            async:false,
            contentType: "application/json; charset=utf-8",
            dataType: "jsonp",
            data: "data="+JSON.stringify(jsondata),
            url:"http://127.0.0.1:7655/usbkey/getcert",
            beforeSend:function(){},
            complete:function(){},
            jsonp:"callback",
            jsonpCallback:"callback",
            success:function (data) {

                if ( data.status == 0 ) {
                    hideprogress();
                    alert(data.message);



                } else {
                    hideprogress();
                    alert(data.message);
                }
            } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

                hideprogress();
                if ( isShowMessage ) {
                    alert(XMLHttpRequest.status);
                    alert(XMLHttpRequest.readyState);
                    alert(textStatus);
                    alert(errorThrown);
                }

            }
        });
    } else {
        showkeywordstamp();
    }
*/

}
//------------------------------------------------------------------------------------------
function ridestamp() {

	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
    add_Seal_Type = 3;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
    signstamp_ridestamp("aa");
    //先获取盖章二维码，在扫码，完成盖章
    //getSealQRCode();
    /*
    var jsondata = new Object();
    jsondata.fileID = currfileid;
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/ridingstamp",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {

            if ( data.status == 0 ) {
                //alert(data.message);

                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
            }

        }
    });

     */
}
//------------------------------------------------------------------------------------------
//验证印章
function verify(){
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
    //showVerifyResult(false,"签章有效","张凤飞飞 202108197703036651","加福禄寿减肥的历史减肥的历史附近的历史减肥的历史就分手甲方减肥返","2020-01-09 12:55:56","2020-01-09 12:55:56","SM2-SM3");
    
    var jsondata = new Object();
    jsondata.fileID = currfileid;
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/verify",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
            hideprogress();
            if ( data.status == 0 ) {
                //alert(data.message);
                verifylist = data.data;
                verifylist_index = 0;
                showVerifyResult(verifylist_index);
                /*
                $.each( list, function(index, content)
                {
                    
                    showVerifyResult(content.verify,content.verify?"签章有效":"签章无效",content.certCN,"",content.signDate,"",content.signAlg);
                });
                */
                //showVerifyResult(false,"签章有效","张凤飞飞 202108197703036651","加福禄寿减肥的历史减肥的历史附近的历史减肥的历史就分手甲方减肥返","2020-01-09 12:55:56","2020-01-09 12:55:56","SM2-SM3");
            } else {
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
            }

        }
    });
    
}
//------------------------------------------------------------------------------------------
function addWatermark(horizontalSpacing,verticalSpacing,firstLineText,firstLineText_FontName, firstLineText_fontSize,
										 firstLineText_color_R,firstLineText_color_G, firstLineText_color_B, firstLineText_alpha,
										 lineSpacing0_1,secondLineText,secondLineText_FontName,secondLineText_fontSize,secondLineText_color_R,
										 secondLineText_color_G,secondLineText_color_B,secondLineText_alpha,lineSpacing1_2,thirdLineText,
										 thirdLineText_FontName,thirdLineText_fontSize,thirdLineText_color_R,thirdLineText_color_G,
										 thirdLineText_color_B,thirdLineText_alpha,rotate)
{
		if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
   
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();

    var jsondata = new Object();
     jsondata.fileID = currfileid;
    jsondata.pageCode = currentpage;
    jsondata.horizontalSpacing = horizontalSpacing;
    jsondata.verticalSpacing = verticalSpacing;
    jsondata.firstLineText = encodeURIComponent(firstLineText);
    jsondata.firstLineText_FontName = encodeURIComponent(firstLineText_FontName);
    jsondata.firstLineText_fontSize = firstLineText_fontSize;
    jsondata.firstLineText_color_R = firstLineText_color_R;
    jsondata.firstLineText_color_G = firstLineText_color_G;
    jsondata.firstLineText_color_B = firstLineText_color_B;
    jsondata.firstLineText_alpha = firstLineText_alpha;
    jsondata.lineSpacing0_1 = lineSpacing0_1;
    jsondata.secondLineText = encodeURIComponent(secondLineText);
    jsondata.secondLineText_FontName = encodeURIComponent(secondLineText_FontName);
    jsondata.secondLineText_fontSize = secondLineText_fontSize;
    jsondata.secondLineText_color_R = secondLineText_color_R;
    jsondata.secondLineText_color_G = secondLineText_color_G;
    jsondata.secondLineText_color_B = secondLineText_color_B;
    jsondata.secondLineText_alpha = secondLineText_alpha;
    jsondata.lineSpacing1_2 = lineSpacing1_2;
    jsondata.thirdLineText = encodeURIComponent(thirdLineText);
    jsondata.thirdLineText_FontName = encodeURIComponent(thirdLineText_FontName);
    jsondata.thirdLineText_fontSize = thirdLineText_fontSize;
    jsondata.thirdLineText_color_R = thirdLineText_color_R;
    jsondata.thirdLineText_color_G = thirdLineText_color_G;
    jsondata.thirdLineText_color_B = thirdLineText_color_B;
    jsondata.thirdLineText_alpha = thirdLineText_alpha;
    jsondata.rotate = rotate;

     
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/docaddwatermark",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
						
            if ( data.status == 0 ) {
                //alert(data.message);

                currfileid = data.data.fileID;
                totalpagecount = data.data.pageCount;
                docpage_1_width  = data.data.imageWidth;
                docpage_1_height = data.data.imageHeight;
                //alert(docpage_1_width+":"+docpage_1_height);

                if ( text_totalpagecount != undefined ) {
                    text_totalpagecount.value = totalpagecount;
                }

                //img_docpage.style.display="";

                AJAX_GetPage(currfileid,currentpage,true);
                isOpenDoc = true;

            } else {
                hideprogress();
                alert(data.message);
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            if ( isShowMessage ) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
                alert(errorThrown);
            }

        }
    });
    
    
}
//------------------------------------------------------------------------------------------
//显示工具栏
function showtoolbar(){
    
  if ( div_tools == null || div_tools != undefined ) {
    div_tools.style.display="";
    div_pagearea.style.height = height - 40 + "px";
    
    pagearea_width = $(div_pageshowarea).width();
    pagearea_height = $(div_pageshowarea).height();
    AJAX_GetPage(currfileid,currentpage,false);
  }
}
//------------------------------------------------------------------------------------------
//隐藏工具栏
function hidetoolbar()
{

  if ( div_tools == null || div_tools != undefined ) {
    div_tools.style.display="none";
    div_pagearea.style.height = height + "px";
    
    pagearea_width = $(div_pageshowarea).width();
    pagearea_height = $(div_pageshowarea).height();
    AJAX_GetPage(currfileid,currentpage,false);
  }
}
//------------------------------------------------------------------------------------------
//获取文档数据
function getFileData()
{

    if ( !isOpenDoc ) {
        func_callback_getsignfiledata("");
        return;
    }
    if (currfileid == null || currfileid == undefined || currfileid == '') {
        func_callback_getsignfiledata("");
        return;
    }
    var jsondata = new Object();
    jsondata.fileID = currfileid;
    showprogress();

    $.ajax({
        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/getfiledata",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
            hideprogress();
            if ( data.status == 0 ) {
                func_callback_getsignfiledata(data.data);
            } else {
                func_callback_getsignfiledata("");
            }
        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            func_callback_getsignfiledata("");

        }
    });


}
//------------------------------------------------------------------------------------------
function getPageCount()
{
	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
	return totalpagecount;
}
//------------------------------------------------------------------------------------------
function setShowRatio(ratio)
{
	add_Seal_Type = 0;
  stopdropstamp();
  hidedropstamp();
  stopqrcodetimer();
	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
	var tempratio = g_Ratio_hundredth * ratio;
	if ( tempratio >= g_Ratio_MAX ) {
		g_Ratio = g_Ratio_MAX;
	} else if ( tempratio <= g_Ratio_MIN ) {
		g_Ratio = g_Ratio_MIN;
	} else {
		g_Ratio = tempratio;
	}
	AutoResizeImage(g_currpageimagedata,docpage_1_width,docpage_1_height,pagearea_width,pagearea_height);
}
//------------------------------------------------------------------------------------------
//放大
function zoomout()
{
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
	var tempratio = (g_Ratio_MAX - g_Ratio_MIN)/2/3;
	if ( g_Ratio + tempratio >= g_Ratio_MAX ) {
		g_Ratio = g_Ratio_MAX;
	} else {
		g_Ratio = g_Ratio + tempratio;
	}
	AutoResizeImage(g_currpageimagedata,docpage_1_width,docpage_1_height,pagearea_width,pagearea_height);
}
//------------------------------------------------------------------------------------------
//缩小
function zoomin()
{
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
	if ( !isOpenDoc ) {alert("您没有打开文档！");return;}
	var tempratio = (g_Ratio_MAX - g_Ratio_MIN)/2/3;
	if ( g_Ratio - tempratio <= g_Ratio_MIN ) {
		g_Ratio = g_Ratio_MIN;
	} else {
		g_Ratio = g_Ratio - tempratio;
	}
	
	AutoResizeImage(g_currpageimagedata,docpage_1_width,docpage_1_height,pagearea_width,pagearea_height);
}
//------------------------------------------------------------------------------------------
function openfile_local()
{


  if ( this.id == null || this.id == undefined ) {
    return;
  }
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
    
    //clearInterval(intervalId);
    text_keystamp.value = "";
    currentpage = 0;
    g_Ratio = 0.0;
    showprogress();
    AJAX_OpenFile_Local();
            
    /*
    //js open file
  var inputObj=document.createElement('input')
  inputObj.setAttribute('id','_ef');
  inputObj.setAttribute('type','file');
  inputObj.setAttribute("style",'visibility:hidden');
  inputObj.setAttribute('accept','.pdf,.ofd');
        
  document.body.appendChild(inputObj);
  inputObj.click();
  intervalId = setInterval(function () {
        if ( inputObj.value != "" ) {
            clearInterval(intervalId);
            text_keystamp.value = "";
            currentpage = 0;
            g_Ratio = 0.0;
            showprogress();
            AJAX_OpenFile_Local(inputObj.value);
        }
  	
	}, 200);
        */
}
//------------------------------------------------------------------------------------------
function savefile_local()
{

    if ( this.id == null || this.id == undefined ) {
        return;
    }
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
    if ( !isOpenDoc ) {alert("您没有打开文档！");return;}

    alert("保存文档对话框，可能在您浏览器的后面弹出.\n请您最小化浏览器窗口，点击保存按钮。");
    var jsondata = new Object();
    jsondata.fileID = currfileid;

    $.ajax({

        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/saveas",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
            hideprogress();
            if ( data.status == 0 ) {
                alert(data.message);


            } else {

                alert(data.message);
            }


        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            //alert(XMLHttpRequest.status);
            //alert(XMLHttpRequest.readyState);
            //alert(textStatus);
            //alert(errorThrown);

        }
    });
}
//------------------------------------------------------------------------------------------
function printfile_local()
{

    if ( this.id == null || this.id == undefined ) {
        return;
    }
    add_Seal_Type = 0;
    stopdropstamp();
    hidedropstamp();
    stopqrcodetimer();
    if ( !isOpenDoc ) {alert("您没有打开文档！");return;}

    alert("打印文档对话框，在您浏览器的后面弹出。\n请您最小化浏览器窗口，点击打印按钮。");
    var jsondata = new Object();
    jsondata.fileID = currfileid;

    $.ajax({

        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/printdocument",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
            hideprogress();
            if ( data.status == 0 ) {
                alert("打印成功！");


            } else {

                alert(data.message);
            }


        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            //alert(XMLHttpRequest.status);
            //alert(XMLHttpRequest.readyState);
            //alert(textStatus);
            //alert(errorThrown);

        }
    });
}
//------------------------------------------------------------------------------------------
function setServerUrl(serverUrl)
{
		if ( serverUrl == null || serverUrl == undefined ) {
        return;
    }
    var jsondata = new Object();
    jsondata.serverUrl = serverUrl;

    $.ajax({

        type:"GET",
        async:false,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        data: "data="+JSON.stringify(jsondata),
        url:"http://127.0.0.1:7655/docview/setserverurl",
        beforeSend:function(){},
        complete:function(){},
        jsonp:"callback",
        jsonpCallback:"callback",
        success:function (data) {
            hideprogress();
            if ( data.status == 0 ) {
                //alert("打印成功！");


            } else {

                alert(data.message);
            }


        } ,error:function (XMLHttpRequest, textStatus, errorThrown) {

            hideprogress();
            //alert(XMLHttpRequest.status);
            //alert(XMLHttpRequest.readyState);
            //alert(textStatus);
            //alert(errorThrown);

        }
    });
}
//------------------------------------------------------------------------------------------

